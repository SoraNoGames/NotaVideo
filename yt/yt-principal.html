
<html>
<head>
	<title>Notavideo</title>
	<link rel="icon" type="image/png" href="../img/mifavicon.ico"> 
	<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js"></script>
	<link id="estilos" rel="stylesheet" type="text/css" href="./css/style-yt-cine.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flexboxgrid/6.3.1/flexboxgrid.min.css" type="text/css" >
	<meta charset="UTF-8">
	<meta name="title" content="NotaVideo App para estudiantes y profesionales de la educación">
    <meta name="description" content="Nota Video permite tomar nota de videos en la misma ventana donde se reproducen, facilitando el trabajo de resumen y analisis del mismo, permitiendo estudiar y aprender más rápido. #notavideo #youtubenotas #facebooknotas">
    <meta name="keywords" content="editor,youtube,facebook,notas,en,video,redactar,resumir,notepad,jacetutoriales">
  	<meta name="author" content="John Doe">
  	<meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=no">
	<meta name="google-site-verification" content="pjQFS-wCTeGVFeYV23BnokSs6wiIxAUMEXiuSrEDg5I" />
	<link href="https://fonts.googleapis.com/css2?family=Arsenal&family=Montserrat+Alternates:wght@100;400&display=swap" rel="stylesheet"> 
	<script src="https://kit.fontawesome.com/2c36e9b7b1.js" crossorigin="anonymous"></script>
	<script src="./js/menu.js"></script>
</head>
<body>
	<header>
		<nav class="row main-container nav_bar" id="nav">
		<div id="nav-left" class="center-xs">
			<img src="../img/logo.png" id = "logo">
		</div>

		<div id="nav-center">
			<input type="text" name="link" id="enlace" placeholder="Pegar link del video" class="box"> <i onclick="limpiar()" id="borrar" class="fas fa-times-circle"></i></input><!-- Agrego espacios en el placeholder y en textos-->

			<a href="#" id="iniciar" class="botones"> INICIAR </a>
		</div>

		<div class="" id="nav-right" >
			<button id="switch" class="switch">
				<span><i class="fas fa-sun"></i></span>
				<span><i class="fas fa-moon"></i></span>
			</button>
			
		</div>

		<div class="menu">
			
			<img src="../img/menu.png" class="menu_icon">
		</div>
	</nav>


		
		<nav class="nav_menu">
			<ul>
				<li><a href="../fb/fb-principal.html">Notavideo Facebook</a></li>
				<li><a href="yt-cine.html" id = "cambio">Cambiar aspecto</a></li>
				<li><a class = "compartir" id="noche">Modo Nocturno</a></li>
				<li><a href="https://www.instagram.com/jace.si/">Instagram</a><span></span></li>
				<li><a href="https://www.youtube.com/channel/UCIuEephCWSjFomnJONNnhsw">Canal de YouTube</a><span></span></li>
				<li><a href="whatsapp://send?text=http://app.notavideo.com.ar/" data-text="BOTÓN COMPARTIR EN WHATSAPP EN MI PÁGINA WEB" data-action="share/whatsapp/share" class = "compartir">Compartir en WhatsApp</a></li>
				<li><a href="../creditos.html">Creditos</a></li>
				<!-- <li><a href="../creditos.html">Donaciones</a></li> -->
			</ul>
		</nav>
	



	</header>

	<section class="start-xs row" id = "contenedor_video">

			<iframe class="col-xs-12 col-sm-8 col-md-8 col-lg-8" id="chau_flex" width="820" height="500" src="https://www.youtube.com/embed/Zs0mvBLtCcw?rel=0&amp;autoplay=1" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>  
			<textarea class = "col-xs-12 col-sm-4 col-md-4 col-lg-4" id="texto" placeholder="Escribí en este lugar tus notas. Ctrl + Barra Espaciadora, para Pausar el video"></textarea>

	</section>


	<div id="herramientas" class = "center-xs">
		<a href="#" id="copiar" class="botones" onclick="copiar()">Copiar texto</a>
		<a href="#" id="guardar" class="botones">Guardar texto</a>
		<input type = "text" name = "nombre" class = "titulo" id = "titulo" placeholder = "Nombre del archivo...">
	</div>



<script type="text/javascript">
//**********************************BOTON DE LIMPIAR********************************/	

	function limpiar() {
  document.getElementById("enlace").value = "";
}

//***********************************MODO NOCTURUNO*********************************/	

	const btnSwitch = document.querySelector('#switch');

	btnSwitch.addEventListener('click', () => {
		document.body.classList.toggle('dark');
		btnSwitch.classList.toggle('active');
	});

	const modo = document.getElementById('noche');

	modo.addEventListener('click', () => {
		document.body.classList.toggle('dark');
		btnSwitch.classList.toggle('active');	
	})



			
/***********************FUNCIÓN PARA COPIAR EL TEXTO*********************************/	

	function copiar(){

		
		document.execCommand('copy');

		   function addLink() {

       			//Toma el texto seleccionado y le agrega la info extra

       			var copyText = document.getElementById("texto");
       			var link = $("#enlace").val();
				copyText.select();
				copyText.setSelectionRange(0, 99999);

        		var selection = window.getSelection(),
        		vidlink = '-------------------------------------------------- <br />' + link + '<br /> -------------------------------------------------- <br /> <br />'
            	pagelink = '<br /><br /> --------------------------------------------------' + '<br /><br /> #notavideo' + '<br /><br /> http://app.notavideo.com.ar' + '<br /><br />https://www.youtube.com/jacetutoriales',
            	copia = vidlink + selection + pagelink,

            	//Crea un contenedor y lo oculta

           		newdiv = document.createElement('div');
        		newdiv.style.position = 'absolute';
        		newdiv.style.left = '-99999px';

        		//Inserta el contenedor, lo llena con el texto y define la nueva seleccion
        		document.body.appendChild(newdiv);
        		newdiv.innerHTML = copia;
        		selection.selectAllChildren(newdiv);

        		window.setTimeout(function () {
            		document.body.removeChild(newdiv);
        		}, 100);
   			}

   		document.addEventListener('copy', addLink);

	}


	
$(document).ready(function(){
	  // Load the IFrame Player API code asynchronously.
  var tag = document.createElement('script');
  tag.src = "https://www.youtube.com/player_api";
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

  // Replace the 'ytplayer' element with an <iframe> and
  // YouTube player after the API code downloads.
  var player;
  var cadena = "";
  var textocompleto=[];
  /*esta afuera de la función para poder agregar los \r\n de salto de linea cada vez que se presiona enter*/
  		
		/*$("#guardar").click(function() { 
			var text = $('#texto').val();
			var file = new File([text],'file.txt', 
			{
			type: 'text/plain;charset=utf-8'
			});
			saveAs(file);
		});*/

/***********************FUNCIÓN CLICK TOMA EL ID DE YOUTUBE*********************************/	

		$("#iniciar").click(function(){
			cadena = $("#enlace").val();
			cadena = cadena.slice(-11);
			if(cadena != ""){
			$('iframe').replaceWith('<div id="ytplayer"></div>');
			function onYouTubePlayerAPIReady() {
				player = new YT.Player('ytplayer', {
				height: '380',
				width: '640',
				videoId: cadena
			});

/***********************FUNCIÓN PAUSA Y REPRODUCCION POR TECLADO*********************************/	

				function cambiar(){
    	    		player.playVideo();
      			}

      			function pausa(){
    	    		player.pauseVideo();
      			}

      			//En el body cuando se presiona una combinacion de teclas, hace la siguiente funcion

      			$('body').on("keydown", function(e) { 
      				
      				if(player.getPlayerState() === 1){

      					//Si el video esta reproduciendose y se apreta 'Ctrl' y 'Espacio', se pausa el video (32 es el codigo ASCII de la barra espaciadora)

           				if (e.ctrlKey && e.which === 32) {
                			pausa();
            			}
            		}
            		else if(player.getPlayerState() === -1 || 2){

            			//Si el video no se inicio o esta pausado, y se usa la combinacion de teclas, se reproduce el video

            			if (e.ctrlKey && e.which === 32) {
                			cambiar();
            			}
            		}
        		});

     		
			}	
			
			onYouTubePlayerAPIReady();
			}else{
			alert("No pego el link");
			}
		});

/***********************FUNCIÓN CHANGE TOMA EL ID DE YOUTUBE*********************************/		

		$("#enlace").change(function(){
			cadena = $("#enlace").val();
			cadena = cadena.slice(-11);
			if(cadena.length == 11){
			$('iframe').replaceWith('<div id="ytplayer"></div>');
			function onYouTubePlayerAPIReady() {
				player = new YT.Player('ytplayer', {
				height: '380',
				width: '640',
				videoId: cadena
			});

/***********************FUNCIÓN PAUSA Y REPRODUCCION POR TECLADO*********************************/	

				function cambiar(){
    	    		player.playVideo();
      			}

      			function pausa(){
    	    		player.pauseVideo();
      			}

      			//En el body cuando se presiona una combinacion de teclas, hace la siguiente funcion

      			$('body').on("keydown", function(e) { 
      				
      				if(player.getPlayerState() === 1){

      					//Si el video esta reproduciendose y se apreta 'Ctrl' y 'Espacio', se pausa el video (32 es el codigo ASCII de la barra espaciadora)

           				if (e.ctrlKey && e.which === 32) {
                			pausa();
            			}
            		}
            		else if(player.getPlayerState() === -1 || 2){

            			//Si el video no se inicio o esta pausado, y se usa la combinacion de teclas, se reproduce el video

            			if (e.ctrlKey && e.which === 32) {
                			cambiar();
            			}
            		}
        		});


			}	
			
			onYouTubePlayerAPIReady();
			}else{
			alert("No pego el link o no es el correcto");
			}
		});

	});	

/***********************************DESCARGAR ARCHIVOS***********************************/

function descargarArchivo(contenidoEnBlob, nombreArchivo) {
    var reader = new FileReader();
    reader.onload = function (event) {
        var save = document.createElement('a');
        save.href = event.target.result;
        save.target = '_blank';
        save.download = nombreArchivo;
        var clicEvent = new MouseEvent('click', {
            'view': window,
                'bubbles': true,
                'cancelable': true
        });
        save.dispatchEvent(clicEvent);
        (window.URL || window.webkitURL).revokeObjectURL(save.href);
    };
    reader.readAsDataURL(contenidoEnBlob);
};

//Función de ayuda: reúne los datos a exportar en un solo objeto

function obtenerDatos() {
    return {
        texto: document.getElementById('texto').value,
        fecha: (new Date()).toLocaleDateString(),
		link: document.getElementById('enlace').value
    };
};

$.fn.enterKey = function (fnc) {
    return this.each(function () {
        $(this).keypress(function (ev) {
            var keycode = (ev.keyCode ? ev.keyCode : ev.which);
            if (keycode == '13') {
                fnc.call(this, ev);
            }
        })
    })
}



//Genera un objeto Blob con los datos en un archivo TXT

function generarTexto(datos) {
    var texto = [];
	texto.push(datos.fecha);
    texto.push('\r\n');
	texto.push('------------------------------');
	texto.push('\r\n');
	texto.push(datos.link);
	texto.push('\r\n');
	texto.push('------------------------------');
	texto.push('\r\n');
	texto.push(datos.texto);

	
	texto.push('\r\n');
	texto.push('\r\n');
	texto.push('------------------------------');
	texto.push('\r\n');
	texto.push('app.notavideo.com.ar');
	texto.push('\r\n');
	texto.push('www.youtube.com/jacetutoriales');
    //El contructor de Blob requiere un Array en el primer parámetro
    //así que no es necesario usar toString. el segundo parámetro
    //es el tipo MIME del archivo
    return new Blob(texto, {
		encoding:"UTF-8",
        type: 'text/plain;charset=UTF-8'
    });
};



document.getElementById('guardar').addEventListener('click', function () {

	//Toma los datos del textbox y el texto puesto en el input del titulo

    var datos = obtenerDatos();
    var name = document.getElementById("titulo").value;

    if(name === ""){

    	//Si el input esta vacio, guarda el archivo como "notas.txt"

    	descargarArchivo(generarTexto(datos), "notas.txt");

    } else {

    	descargarArchivo(generarTexto(datos), name, ".txt");

	}

}, false);


/*******************************************************************************/	
		
		
		
</script>


</body>
</html>